# JavaFXåº”ç”¨æ‰“åŒ…æœºåˆ¶è¯¦è§£

## æ‰“åŒ…åçš„å•ä¸€exeæ–‡ä»¶ç»“æ„

### æœ€ç»ˆç”¨æˆ·çœ‹åˆ°çš„ï¼š
```
WatermarkApp.exe  â† ç”¨æˆ·åªéœ€è¦è¿™ä¸€ä¸ªæ–‡ä»¶
```

### exeæ–‡ä»¶å†…éƒ¨å®é™…åŒ…å«ï¼š
```
WatermarkApp.exe (ç”±jpackageç”Ÿæˆ)
â”œâ”€â”€ Javaè¿è¡Œæ—¶ç¯å¢ƒ (JRE)
â”œâ”€â”€ JavaFXåº“æ–‡ä»¶
â”œâ”€â”€ åº”ç”¨ç¨‹åºJARæ–‡ä»¶
â”‚   â”œâ”€â”€ Javaä¸šåŠ¡é€»è¾‘ä»£ç 
â”‚   â”œâ”€â”€ Vueç¼–è¯‘åçš„é™æ€èµ„æº
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ css/app.css
â”‚   â”‚   â”œâ”€â”€ js/app.js
â”‚   â”‚   â””â”€â”€ assets/
â”‚   â””â”€â”€ SQLite JDBCé©±åŠ¨
â””â”€â”€ åŸç”Ÿå¯åŠ¨å™¨
```

## è¯¦ç»†æ‰“åŒ…æµç¨‹

### 1. å¼€å‘é˜¶æ®µ
```
frontend/                    backend/
â”œâ”€â”€ src/                    â”œâ”€â”€ src/main/java/
â”œâ”€â”€ package.json           â”œâ”€â”€ src/main/resources/
â””â”€â”€ vite.config.js         â”‚   â””â”€â”€ web/ (ç©ºç›®å½•)
                           â””â”€â”€ pom.xml
```

### 2. æ„å»ºé˜¶æ®µ
```bash
# Step 1: æ„å»ºVueå‰ç«¯
cd frontend
npm run build
# ç”Ÿæˆ frontend/dist/ ç›®å½•

# Step 2: å¤åˆ¶åˆ°Javaèµ„æºç›®å½•
cp -r frontend/dist/* backend/src/main/resources/web/

# Step 3: æ‰“åŒ…Javaåº”ç”¨
cd backend  
mvn clean package
# ç”Ÿæˆ backend/target/watermark-app.jar
```

### 3. æœ€ç»ˆæ‰“åŒ…é˜¶æ®µ
```bash
# Step 4: ä½¿ç”¨jpackageç”Ÿæˆexe
jpackage \
  --input backend/target/ \
  --name "WatermarkApp" \
  --main-jar watermark-app.jar \
  --main-class com.watermark.WatermarkApplication \
  --type exe \
  --icon app.ico \
  --app-version 1.0.0
  
# ç”Ÿæˆ WatermarkApp.exe (åŒ…å«æ‰€æœ‰å†…å®¹)
```

## è¿è¡Œæ—¶æœºåˆ¶

### ç”¨æˆ·åŒå‡»exeåçš„æ‰§è¡Œæµç¨‹ï¼š
```
1. exeå¯åŠ¨ â†’ è§£å‹å†…ç½®JREåˆ°ä¸´æ—¶ç›®å½•
2. å¯åŠ¨JavaFXåº”ç”¨ â†’ åŠ è½½ä¸»ç±»WatermarkApplication
3. JavaFXåˆ›å»ºWebView â†’ åŠ è½½classpath:/web/index.html
4. WebViewæ¸²æŸ“Vueç•Œé¢ â†’ Vue JavaScriptå¼€å§‹æ‰§è¡Œ
5. å»ºç«‹JS-Java Bridge â†’ å‰åç«¯å¼€å§‹é€šä¿¡
6. åº”ç”¨å®Œå…¨å¯åŠ¨ â†’ ç”¨æˆ·çœ‹åˆ°å®Œæ•´ç•Œé¢
```

### å…³é”®ä»£ç ç¤ºä¾‹ï¼š

**JavaFXåŠ è½½Vueèµ„æºï¼š**
```java
public class WatermarkApplication extends Application {
    @Override
    public void start(Stage primaryStage) {
        WebView webView = new WebView();
        WebEngine webEngine = webView.getEngine();
        
        // ä»JARåŒ…å†…åŠ è½½Vueåº”ç”¨
        URL indexUrl = getClass().getResource("/web/index.html");
        webEngine.load(indexUrl.toExternalForm());
        
        // è®¾ç½®çª—å£
        Scene scene = new Scene(webView, 1200, 800);
        primaryStage.setScene(scene);
        primaryStage.setTitle("æ°´å°å¤„ç†åº”ç”¨");
        primaryStage.show();
    }
}
```

## è‡ªåŠ¨åŒ–æ„å»ºé…ç½®

### Mavenå®Œæ•´é…ç½® (backend/pom.xml)ï¼š
```xml
<project>
    <properties>
        <javafx.version>17.0.2</javafx.version>
        <javafx.maven.plugin.version>0.0.8</javafx.maven.plugin.version>
    </properties>
    
    <dependencies>
        <dependency>
            <groupId>org.openjfx</groupId>
            <artifactId>javafx-controls</artifactId>
            <version>${javafx.version}</version>
        </dependency>
        <dependency>
            <groupId>org.openjfx</groupId>
            <artifactId>javafx-web</artifactId>
            <version>${javafx.version}</version>
        </dependency>
    </dependencies>
    
    <build>
        <plugins>
            <!-- å‰ç«¯æ„å»ºæ’ä»¶ -->
            <plugin>
                <groupId>com.github.eirslett</groupId>
                <artifactId>frontend-maven-plugin</artifactId>
                <version>1.12.1</version>
                <configuration>
                    <workingDirectory>../frontend</workingDirectory>
                </configuration>
                <executions>
                    <execution>
                        <id>npm install</id>
                        <goals><goal>npm</goal></goals>
                        <configuration>
                            <arguments>install</arguments>
                        </configuration>
                    </execution>
                    <execution>
                        <id>npm run build</id>
                        <goals><goal>npm</goal></goals>
                        <configuration>
                            <arguments>run build</arguments>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            
            <!-- å¤åˆ¶å‰ç«¯èµ„æºæ’ä»¶ -->
            <plugin>
                <artifactId>maven-resources-plugin</artifactId>
                <executions>
                    <execution>
                        <id>copy-vue-resources</id>
                        <phase>process-resources</phase>
                        <goals><goal>copy-resources</goal></goals>
                        <configuration>
                            <outputDirectory>${project.build.outputDirectory}/web</outputDirectory>
                            <resources>
                                <resource>
                                    <directory>../frontend/dist</directory>
                                </resource>
                            </resources>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            
            <!-- JavaFXåº”ç”¨æ‰“åŒ…æ’ä»¶ -->
            <plugin>
                <groupId>org.openjfx</groupId>
                <artifactId>javafx-maven-plugin</artifactId>
                <version>${javafx.maven.plugin.version}</version>
                <configuration>
                    <mainClass>com.watermark.WatermarkApplication</mainClass>
                </configuration>
            </plugin>
            
            <!-- jpackageæœ¬åœ°åº”ç”¨æ‰“åŒ… -->
            <plugin>
                <groupId>org.panteleyev</groupId>
                <artifactId>jpackage-maven-plugin</artifactId>
                <version>1.4.0</version>
                <configuration>
                    <name>WatermarkApp</name>
                    <appVersion>1.0.0</appVersion>
                    <vendor>Your Company</vendor>
                    <destination>target/installer</destination>
                    <module>watermark.app/com.watermark.WatermarkApplication</module>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

## ä¸€é”®æ„å»ºè„šæœ¬

### Windowsæ‰¹å¤„ç†æ–‡ä»¶ (build.bat)ï¼š
```batch
@echo off
echo å¼€å§‹æ„å»ºæ°´å°åº”ç”¨...

echo Step 1: æ„å»ºå‰ç«¯Vueåº”ç”¨
cd frontend
call npm install
call npm run build
cd ..

echo Step 2: æ„å»ºJavaåº”ç”¨å¹¶æ‰“åŒ…exe
cd backend
call mvn clean package jpackage:jpackage
cd ..

echo æ„å»ºå®Œæˆï¼exeæ–‡ä»¶ä½ç½®: backend/target/installer/WatermarkApp.exe
pause
```

## æ€»ç»“

### âœ… æ˜¯çš„ï¼Œfrontendå¯ä»¥å®Œå…¨æ‰“åŒ…åˆ°åç«¯ï¼š

1. **å¼€å‘æ—¶**: frontendå’Œbackendåˆ†ç¦»å¼€å‘
2. **æ„å»ºæ—¶**: Vueæ„å»ºä¸ºé™æ€èµ„æºï¼Œå¤åˆ¶åˆ°Java classpath
3. **æ‰“åŒ…æ—¶**: æ‰€æœ‰å†…å®¹(Javaä»£ç +Vueèµ„æº+JRE)æ‰“åŒ…ä¸ºå•ä¸€exe
4. **è¿è¡Œæ—¶**: ç”¨æˆ·åªéœ€åŒå‡»exeï¼ŒJavaFX WebViewåŠ è½½å†…ç½®Vueåº”ç”¨

### ğŸ”„ å®Œæ•´æµç¨‹ï¼š
**Vueæºç ** â†’ **ç¼–è¯‘é™æ€èµ„æº** â†’ **æ‰“åŒ…è¿›JAR** â†’ **jpackageç”Ÿæˆexe** â†’ **ç”¨æˆ·åŒå‡»è¿è¡Œ**

è¿™æ ·æ—¢ä¿æŒäº†Vueçš„å¼€å‘ä½“éªŒï¼Œåˆå®ç°äº†å•æ–‡ä»¶éƒ¨ç½²çš„ç›®æ ‡ï¼