# 项目目录结构设计

## Vue代码组织方式对比

### 方案一：分离目录结构 (推荐)

```
watermark-app/
├── backend/                          # Java后端代码
│   ├── src/main/java/
│   │   └── com/watermark/
│   │       ├── WatermarkApplication.java
│   │       ├── controller/
│   │       ├── service/
│   │       └── bridge/
│   ├── src/main/resources/
│   │   ├── web/                      # Vue编译后的静态资源 (构建时复制)
│   │   │   ├── index.html
│   │   │   ├── assets/
│   │   │   └── js/
│   │   └── application.properties
│   └── pom.xml
├── frontend/                         # Vue前端代码 (开发时)
│   ├── src/
│   │   ├── components/
│   │   ├── views/
│   │   ├── store/
│   │   └── App.vue
│   ├── public/
│   ├── package.json
│   ├── vite.config.js
│   └── dist/                         # 构建输出 (复制到backend/src/main/resources/web/)
└── README.md
```

### 方案二：单一目录结构

```
watermark-app/
├── src/main/java/                    # Java代码
│   └── com/watermark/
├── src/main/resources/
│   └── web/                          # Vue编译后静态资源
├── web-ui/                           # Vue源码 (在Java项目内)
│   ├── src/
│   ├── package.json
│   └── dist/
└── pom.xml
```

## 推荐方案详细说明

### 为什么推荐分离目录结构？

#### ✅ 优点：
1. **清晰的职责分离**
   - 前端和后端代码完全独立
   - 每个子项目有自己的配置文件
   - 便于团队分工开发

2. **独立的开发环境**
   ```bash
   # 前端开发
   cd frontend
   npm run dev          # 独立的Vue开发服务器
   npm run build        # 构建静态资源
   
   # 后端开发
   cd backend
   mvn spring-boot:run  # 或直接运行JavaFX应用
   ```

3. **灵活的构建流程**
   - 前端可以独立调试和测试
   - 支持前端热重载开发
   - 构建时自动复制静态资源到Java项目

4. **版本控制友好**
   - 前后端依赖分离
   - Git提交历史更清晰
   - 便于代码review

#### ❌ 单一目录的问题：
- Java和Node.js依赖混合
- 构建配置复杂
- 开发调试不便

## 具体实现方案

### 开发时工作流程

1. **前端开发阶段**：
```bash
cd frontend
npm run dev    # 启动Vue开发服务器 (http://localhost:3000)
# 在浏览器中调试Vue组件和界面
```

2. **集成测试阶段**：
```bash
cd frontend
npm run build  # 构建静态资源到 dist/

# 复制到Java项目 (可以用Maven插件自动化)
cp -r dist/* ../backend/src/main/resources/web/

cd ../backend
mvn javafx:run # 运行JavaFX应用，加载Vue静态资源
```

3. **生产构建**：
```bash
# 完整构建脚本
./build.sh     # 自动执行前端构建+复制+Java打包
```

### Maven集成配置

在backend/pom.xml中添加前端构建插件：

```xml
<plugin>
    <groupId>com.github.eirslett</groupId>
    <artifactId>frontend-maven-plugin</artifactId>
    <version>1.12.1</version>
    <configuration>
        <workingDirectory>../frontend</workingDirectory>
    </configuration>
    <executions>
        <execution>
            <id>install node and npm</id>
            <goals>
                <goal>install-node-and-npm</goal>
            </goals>
        </execution>
        <execution>
            <id>npm install</id>
            <goals>
                <goal>npm</goal>
            </goals>
            <configuration>
                <arguments>install</arguments>
            </configuration>
        </execution>
        <execution>
            <id>npm run build</id>
            <goals>
                <goal>npm</goal>
            </goals>
            <configuration>
                <arguments>run build</arguments>
            </configuration>
        </execution>
    </executions>
</plugin>

<plugin>
    <artifactId>maven-resources-plugin</artifactId>
    <executions>
        <execution>
            <id>copy-vue-app</id>
            <phase>generate-resources</phase>
            <goals>
                <goal>copy-resources</goal>
            </goals>
            <configuration>
                <outputDirectory>src/main/resources/web</outputDirectory>
                <resources>
                    <resource>
                        <directory>../frontend/dist</directory>
                    </resource>
                </resources>
            </configuration>
        </execution>
    </executions>
</plugin>
```

### JavaFX加载静态资源

```java
public class WebViewController {
    @FXML
    private WebView webView;
    
    public void initialize() {
        WebEngine webEngine = webView.getEngine();
        
        // 加载classpath下的Vue应用
        URL indexUrl = getClass().getResource("/web/index.html");
        webEngine.load(indexUrl.toExternalForm());
        
        // 设置JS-Java Bridge
        webEngine.getLoadWorker().stateProperty().addListener((obs, oldState, newState) -> {
            if (newState == Worker.State.SUCCEEDED) {
                JSObject window = (JSObject) webEngine.executeScript("window");
                window.setMember("java", new JsBridge());
            }
        });
    }
}
```

## 总结

**推荐使用分离目录结构**，因为：

1. **开发体验更好** - 前端可以独立热重载开发
2. **职责清晰** - 前后端代码物理分离，便于维护
3. **构建灵活** - 支持独立构建和集成构建
4. **团队协作友好** - 前后端开发者可以并行工作

这种结构既保持了前端现代化开发体验，又能很好地集成到JavaFX应用中。